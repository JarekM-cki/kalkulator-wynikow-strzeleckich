            // Conditions form
            const saveConditionsBtn = document.getElementById('save-conditions-btn');
            const conditionsSaved = document.getElementById('conditions-saved');
            
            saveConditionsBtn.addEventListener('click', function() {
                conditionsSaved.classList.remove('hidden');
                setTimeout(() => {
                    conditionsSaved.classList.add('hidden');
                }, 3000);
            });        .ammo-option-btn.active {
            background-color: var(--primary-color);
            color: white;
        }<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Wyników Strzelań - PSBS Międzyrzecz</title>
    <style>
        :root {
            --primary-color: #3f51b5;
            --secondary-color: #7986cb;
            --background-color: #f5f5f5;
            --text-color: #333;
            --section-bg: #fff;
            --border-color: #ddd;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            padding-bottom: 80px; /* Space for navigation */
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 1.5rem;
            margin: 0;
        }
        
        h2 {
            font-size: 1.3rem;
            margin: 1rem 0;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 0.5rem;
        }
        
        section {
            padding: 1rem;
            margin: 1rem;
            background-color: var(--section-bg);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        label {
            display: block;
            margin: 0.5rem 0;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            margin: 0.5rem 0;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .ammo-option-btn {
            background-color: #e0e0e0;
            color: var(--text-color);
        }
        
        .tab-btn {
            background-color: #e0e0e0;
            color: var(--text-color);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0 0.25rem;
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            margin-top: 1rem;
        }
        
        .results {
            background-color: #e8eaf6;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .nav-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--primary-color);
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        }
        
        .nav-button {
            color: white;
            text-decoration: none;
            padding: 1rem 0;
            text-align: center;
            flex: 1;
            font-size: 0.85rem;
        }
        
        .nav-button:hover, .nav-button.active {
            background-color: var(--secondary-color);
        }
        
        .hidden {
            display: none;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        th, td {
            border: 1px solid var(--border-color);
            padding: 0.5rem;
            text-align: left;
        }
        
        th {
            background-color: var(--secondary-color);
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .collapsible {
            background-color: #e8eaf6;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }
        
        .details-button {
            background-color: var(--secondary-color);
        }
        
        .grade-very-good {
            color: var(--success-color);
            font-weight: bold;
        }
        
        .grade-good {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .grade-satisfactory {
            color: #ff9800;
            font-weight: bold;
        }
        
        .grade-fail {
            color: var(--danger-color);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header>
        <h1>PSBS Międzyrzecz 2025 r.</h1>
        <h2 style="color: white; border-bottom: none; padding-bottom: 0; margin: 0.5rem 0;">KALKULATOR WYNIKÓW STRZELAŃ</h2>
    </header>
    
    <!-- Zestawienie wyników -->
    <section id="results-summary" class="section">
        <h2>Zestawienie wyników</h2>
        <form id="results-form">
            <label for="total-shooters">Liczba strzelających:</label>
            <input type="number" id="total-shooters" required min="1">
            
            <label for="very-good">Bardzo dobrych:</label>
            <input type="number" id="very-good" required min="0">
            
            <label for="good">Dobrych:</label>
            <input type="number" id="good" required min="0">
            
            <label for="satisfactory">Dostatecznych:</label>
            <input type="number" id="satisfactory" required min="0">
            
            <label for="fail">Niedostatecznych:</label>
            <input type="number" id="fail" required min="0">
            
            <button type="button" id="calculate-btn">Oblicz wyniki</button>
        </form>
        
        <div id="results-output" class="results hidden">
            <div class="result-item">
                <span>Strzelało:</span>
                <span id="total-result">0</span>
            </div>
            <div class="result-item">
                <span>Bardzo dobrych:</span>
                <span id="very-good-result">0</span>
            </div>
            <div class="result-item">
                <span>Dobrych:</span>
                <span id="good-result">0</span>
            </div>
            <div class="result-item">
                <span>Dostatecznych:</span>
                <span id="satisfactory-result">0</span>
            </div>
            <div class="result-item">
                <span>Niedostatecznych:</span>
                <span id="fail-result">0</span>
            </div>
            <div class="result-item">
                <span>Procent wykonania:</span>
                <span id="percentage-result">0%</span>
            </div>
            <div class="result-item">
                <span>Ocena średnia arytmetyczna:</span>
                <span id="average-result">0.00</span>
            </div>
            <div class="result-item">
                <span>Ocena ogólna:</span>
                <span id="overall-result">-</span>
            </div>
            
            <button type="button" id="details-btn" class="details-button">Pokaż szczegóły</button>
            
            <div id="calculation-details" class="collapsible hidden">
                <h3>Szczegółowe obliczenia</h3>
                <p>Ocenę wyszkolenia strzeleckiego ze strzelań szkolnych i bojowych ustala się na podstawie średniej arytmetycznej określonej z dokładnością do jednej setnej w następujący sposób:</p>
                <ul>
                    <li>"bardzo dobra" (bdb) - średnia arytmetyczna wynosi co najmniej 4,51</li>
                    <li>"dobra" (db) - średnia arytmetyczna wynosi co najmniej 3,51</li>
                    <li>"dostateczna" (dst) - średnia arytmetyczna wynosi co najmniej 2,51</li>
                </ul>
                
                <div id="detailed-calculations">
                    <!-- Detailed calculations will be inserted here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Zużycie amunicji -->
    <section id="ammo-usage" class="section hidden">
        <h2>Zużycie amunicji</h2>
        <form id="ammo-form">
            <label for="ammo-type">Rodzaj amunicji:</label>
            <select id="ammo-type">
                <option value="9x18">9×18 mm Makarowa (1,38 zł/szt.)</option>
                <option value="9x19">9×19 mm Parabellum (1,15 zł/szt.)</option>
                <option value="5.56">5,56×45 mm NATO (2,50 zł/szt.)</option>
                <option value="7.62">7.62×51 mm NATO (3,45 zł/szt.)</option>
            </select>
            
            <label for="shooters-count">Liczba strzelców:</label>
            <input type="number" id="shooters-count" min="1" required>
            
            <label for="shots-per-shooter">Liczba strzałów na strzelca:</label>
            <input type="number" id="shots-per-shooter" min="1" required>
            
            <label for="ammo-option">Wybierz rodzaj amunicji:</label>
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button type="button" id="regular-ammo-btn" class="ammo-option-btn active" style="flex: 1;">Amunicja zwykła</button>
                <button type="button" id="tracer-ammo-btn" class="ammo-option-btn" style="flex: 1;">Amunicja smugowa (1:3)</button>
            </div>
            
            <button type="button" id="calculate-ammo-btn">Oblicz zużycie</button>
        </form>
        
        <div id="ammo-results" class="results hidden">
            <h3>Wyniki kalkulacji</h3>
            <div class="result-item">
                <span>Rodzaj amunicji:</span>
                <span id="ammo-type-result">-</span>
            </div>
            <div class="result-item">
                <span>Liczba strzelających:</span>
                <span id="shooters-result">0</span>
            </div>
            <div class="result-item">
                <span>Amunicja na osobę:</span>
                <span id="ammo-per-person-result">0 szt.</span>
            </div>
            <div class="result-item">
                <span>Całkowita ilość amunicji:</span>
                <span id="total-ammo-result">0 szt.</span>
            </div>
            <div id="ammo-breakdown" class="hidden">
                <div class="result-item">
                    <span>Amunicja zwykła:</span>
                    <span id="regular-ammo-result">0 szt.</span>
                </div>
                <div class="result-item">
                    <span>Amunicja smugowa:</span>
                    <span id="tracer-ammo-result">0 szt.</span>
                </div>
            </div>
            <div class="result-item">
                <span>Koszt całkowity:</span>
                <span id="total-cost-result">0.00 zł</span>
            </div>
        </div>
    </section>

    <!-- Warunki strzelania -->
    <section id="shooting-conditions" class="section hidden">
        <h2>Warunki strzelania</h2>
        <div class="conditions-tabs" style="display: flex; margin-bottom: 15px;">
            <button type="button" id="weather-tab-btn" class="tab-btn active" style="flex: 1;">Warunki pogodowe</button>
            <button type="button" id="collimator-tab-btn" class="tab-btn" style="flex: 1;">Wizowanie kolimatora</button>
        </div>
        
        <div id="weather-conditions" class="tab-content">
            <form id="conditions-form">
                <label for="weather">Warunki pogodowe:</label>
                <select id="weather">
                    <option value="sunny">Słonecznie</option>
                    <option value="cloudy">Pochmurno</option>
                    <option value="rainy">Deszczowo</option>
                    <option value="windy">Wietrznie</option>
                    <option value="foggy">Mgliście</option>
                </select>
                
                <label for="temperature">Temperatura (°C):</label>
                <input type="number" id="temperature" min="-30" max="50" value="20">
                
                <label for="wind-speed">Prędkość wiatru (km/h):</label>
                <input type="number" id="wind-speed" min="0" max="100" value="5">
                
                <label for="wind-direction">Kierunek wiatru:</label>
                <select id="wind-direction">
                    <option value="N">Północny</option>
                    <option value="NE">Północno-wschodni</option>
                    <option value="E">Wschodni</option>
                    <option value="SE">Południowo-wschodni</option>
                    <option value="S">Południowy</option>
                    <option value="SW">Południowo-zachodni</option>
                    <option value="W">Zachodni</option>
                    <option value="NW">Północno-zachodni</option>
                </select>
                
                <label for="visibility">Widoczność (m):</label>
                <input type="number" id="visibility" min="100" max="10000" value="1000">
                
                <button type="button" id="save-conditions-btn">Zapisz warunki</button>
            </form>
            
            <div id="conditions-saved" class="results hidden">
                <p>Warunki strzelania zostały zapisane.</p>
            </div>
        </div>
        
        <div id="collimator-settings" class="tab-content hidden">
            <h3>Wizowanie kolimatora</h3>
            <div class="collimator-info">
                <p>Poniżej znajduje się instrukcja wizowania kolimatora oraz kalkulator przesunięcia punktu trafienia.</p>
            </div>
            
            <div class="collimator-adjustment">
                <h4>Kalkulator przesunięcia</h4>
                <form id="collimator-form">
                    <label for="distance">Dystans zerowania (m):</label>
                    <input type="number" id="distance" min="25" max="500" value="100">
                    
                    <label for="current-x">Obecne przesunięcie w poziomie (cm):</label>
                    <input type="number" id="current-x" value="0">
                    
                    <label for="current-y">Obecne przesunięcie w pionie (cm):</label>
                    <input type="number" id="current-y" value="0">
                    
                    <label for="clicks-per-moa">Liczba kliknięć na 1 MOA:</label>
                    <select id="clicks-per-moa">
                        <option value="1">1 kliknięcie na MOA</option>
                        <option value="2">2 kliknięcia na MOA</option>
                        <option value="4" selected>4 kliknięcia na MOA</option>
                        <option value="8">8 kliknięć na MOA</option>
                    </select>
                    
                    <button type="button" id="calculate-adjustment-btn">Oblicz korektę</button>
                </form>
                
                <div id="adjustment-results" class="results hidden">
                    <h4>Wymagana korekta:</h4>
                    <div class="result-item">
                        <span>W poziomie:</span>
                        <span id="horizontal-clicks">0 kliknięć</span>
                    </div>
                    <div class="result-item">
                        <span>W pionie:</span>
                        <span id="vertical-clicks">0 kliknięć</span>
                    </div>
                    <div class="collimator-instruction">
                        <p id="adjustment-instruction">Obróć pokrętło kolimatora zgodnie z powyższymi wskazówkami, aby skorygować punkty trafienia.</p>
                    </div>
                </div>
            </div>
            
            <div class="collimator-guide">
                <h4>Procedura wizowania kolimatora</h4>
                <ol>
                    <li>Upewnij się, że broń jest rozładowana i bezpieczna.</li>
                    <li>Stabilnie zamocuj broń w statywie lub worku strzeleckim.</li>
                    <li>Ustaw tarczę na wybranym dystansie zerowania (zazwyczaj 25, 50 lub 100 metrów).</li>
                    <li>Oddaj co najmniej 3 strzały, celując w środek tarczy.</li>
                    <li>Zmierz odchylenie średniego punktu trafienia od środka tarczy (w poziomie i pionie).</li>
                    <li>Wprowadź wartości do kalkulatora powyżej, aby obliczyć wymaganą liczbę kliknięć.</li>
                    <li>Dokonaj korekty według wskazań kalkulatora.</li>
                    <li>Oddaj kolejną grupę strzałów, aby sprawdzić skuteczność korekty.</li>
                    <li>W razie potrzeby powtórz proces.</li>
                </ol>
            </div>
            
            <div class="collimator-tips">
                <h4>Wskazówki</h4>
                <ul>
                    <li>Zawsze wizuj kolimator w takich samych warunkach, w jakich będziesz strzelać.</li>
                    <li>Pamiętaj, że 1 MOA to około 2,9 cm na 100 metrach.</li>
                    <li>Kierunek obrotu pokrętła: "w prawo" oznacza zgodnie z ruchem wskazówek zegara.</li>
                    <li>Większość kolimatorów posiada oznaczenia U (up), D (down), L (left), R (right) wskazujące kierunek przemieszczenia punktu trafienia.</li>
                    <li>Sprawdź w instrukcji kolimatora dokładną wartość MOA dla pojedynczego kliknięcia.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Dane taktyczno-techniczne -->
    <section id="technical-data" class="section hidden">
        <h2>Dane taktyczno-techniczne</h2>
        <table>
            <thead>
                <tr>
                    <th>Rodzaj broni</th>
                    <th>Kaliber</th>
                    <th>Masa (bez magazynka)</th>
                    <th>Pojemność magazynka</th>
                    <th>Zasięg skuteczny</th>
                    <th>Mechanizm</th>
                    <th>Prędkość wylotowa</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>MSBS Grot (C16 FB-M2)</td>
                    <td>5,56×45 mm NATO</td>
                    <td>3,6 kg</td>
                    <td>30</td>
                    <td>400-600 m</td>
                    <td>Automatyczny</td>
                    <td>870 m/s</td>
                </tr>
                <tr>
                    <td>VIS 100</td>
                    <td>9×19 mm Parabellum</td>
                    <td>0,73 kg</td>
                    <td>15</td>
                    <td>50 m</td>
                    <td>Samopowtarzalny</td>
                    <td>360 m/s</td>
                </tr>
                <tr>
                    <td>PW WIST-94</td>
                    <td>9×19 mm Parabellum</td>
                    <td>0,72 kg</td>
                    <td>16</td>
                    <td>50 m</td>
                    <td>Samopowtarzalny</td>
                    <td>360 m/s</td>
                </tr>
                <tr>
                    <td>UKM-2000P</td>
                    <td>7,62×51 mm NATO</td>
                    <td>8,4 kg</td>
                    <td>100 (taśma)</td>
                    <td>1000 m</td>
                    <td>Automatyczny</td>
                    <td>840 m/s</td>
                </tr>
                <tr>
                    <td>PW-83</td>
                    <td>9×18 mm Makarov</td>
                    <td>0,73 kg</td>
                    <td>8</td>
                    <td>50 m</td>
                    <td>Samopowtarzalny</td>
                    <td>315 m/s</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Navigation -->
    <div class="nav-container">
        <a href="#results-summary" class="nav-button active" data-section="results-summary">Kalkulator wyników</a>
        <a href="#ammo-usage" class="nav-button" data-section="ammo-usage">Zużycie amunicji</a>
        <a href="#shooting-conditions" class="nav-button" data-section="shooting-conditions">Warunki strzelania</a>
        <a href="#technical-data" class="nav-button" data-section="technical-data">Dane techniczne</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Navigation
            const sections = document.querySelectorAll('.section');
            const navButtons = document.querySelectorAll('.nav-button');
            
            navButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Hide all sections
                    sections.forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    // Remove active class from all buttons
                    navButtons.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Show selected section
                    const sectionId = this.getAttribute('data-section');
                    document.getElementById(sectionId).classList.remove('hidden');
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                });
            });
            
            // Results calculator
            const calculateBtn = document.getElementById('calculate-btn');
            const resultsOutput = document.getElementById('results-output');
            const detailsBtn = document.getElementById('details-btn');
            const calculationDetails = document.getElementById('calculation-details');
            
            calculateBtn.addEventListener('click', function() {
                const totalShooters = parseInt(document.getElementById('total-shooters').value) || 0;
                const veryGood = parseInt(document.getElementById('very-good').value) || 0;
                const good = parseInt(document.getElementById('good').value) || 0;
                const satisfactory = parseInt(document.getElementById('satisfactory').value) || 0;
                const fail = parseInt(document.getElementById('fail').value) || 0;
                
                // Validation
                const sum = veryGood + good + satisfactory + fail;
                if (sum !== totalShooters) {
                    alert('Suma ocen musi być równa liczbie strzelających!');
                    return;
                }
                
                // Calculate results
                const successCount = veryGood + good + satisfactory;
                const successPercentage = (successCount / totalShooters * 100).toFixed(2);
                
                // Calculate average grade
                // Very good = 5, Good = 4, Satisfactory = 3, Fail = 2
                const weightedSum = (veryGood * 5) + (good * 4) + (satisfactory * 3) + (fail * 2);
                const average = (weightedSum / totalShooters).toFixed(2);
                
                // Determine overall grade
                let overallGrade = '';
                let overallClass = '';
                if (average >= 4.51) {
                    overallGrade = 'Bardzo dobra';
                    overallClass = 'grade-very-good';
                } else if (average >= 3.51) {
                    overallGrade = 'Dobra';
                    overallClass = 'grade-good';
                } else if (average >= 2.51) {
                    overallGrade = 'Dostateczna';
                    overallClass = 'grade-satisfactory';
                } else {
                    overallGrade = 'Niedostateczna';
                    overallClass = 'grade-fail';
                }
                
                // Update results
                document.getElementById('total-result').textContent = totalShooters;
                document.getElementById('very-good-result').textContent = veryGood;
                document.getElementById('good-result').textContent = good;
                document.getElementById('satisfactory-result').textContent = satisfactory;
                document.getElementById('fail-result').textContent = fail;
                document.getElementById('percentage-result').textContent = successPercentage + '%';
                document.getElementById('average-result').textContent = average;
                
                const overallResultElement = document.getElementById('overall-result');
                overallResultElement.textContent = overallGrade;
                overallResultElement.className = overallClass;
                
                // Update detailed calculations
                const detailedCalc = document.getElementById('detailed-calculations');
                detailedCalc.innerHTML = `
                    <p>Obliczenia:</p>
                    <p>Oceny bardzo dobre: ${veryGood} × 5 = ${veryGood * 5}</p>
                    <p>Oceny dobre: ${good} × 4 = ${good * 4}</p>
                    <p>Oceny dostateczne: ${satisfactory} × 3 = ${satisfactory * 3}</p>
                    <p>Oceny niedostateczne: ${fail} × 2 = ${fail * 2}</p>
                    <p>Suma punktów: ${weightedSum}</p>
                    <p>Średnia: ${weightedSum} ÷ ${totalShooters} = ${average}</p>
                    <p>Ocena ogólna: ${overallGrade} (średnia ${average})</p>
                `;
                
                // Show results
                resultsOutput.classList.remove('hidden');
            });
            
            detailsBtn.addEventListener('click', function() {
                calculationDetails.classList.toggle('hidden');
                this.textContent = calculationDetails.classList.contains('hidden') ? 'Pokaż szczegóły' : 'Ukryj szczegóły';
            });
            
            // Ammo calculator
            const calculateAmmoBtn = document.getElementById('calculate-ammo-btn');
            const ammoResults = document.getElementById('ammo-results');
            const ammoBreakdown = document.getElementById('ammo-breakdown');
            
            // Ammo type selection buttons
            const regularAmmoBtn = document.getElementById('regular-ammo-btn');
            const tracerAmmoBtn = document.getElementById('tracer-ammo-btn');
            
            regularAmmoBtn.addEventListener('click', function() {
                regularAmmoBtn.classList.add('active');
                tracerAmmoBtn.classList.remove('active');
            });
            
            tracerAmmoBtn.addEventListener('click', function() {
                tracerAmmoBtn.classList.add('active');
                regularAmmoBtn.classList.remove('active');
            });
            
            const ammoPrices = {
                '9x18': 1.38,
                '9x19': 1.15,
                '5.56': 2.50,
                '7.62': 3.45
            };
            
            const ammoNames = {
                '9x18': '9×18 mm Makarowa',
                '9x19': '9×19 mm Parabellum',
                '5.56': '5,56×45 mm NATO',
                '7.62': '7.62×51 mm NATO'
            };
            
            calculateAmmoBtn.addEventListener('click', function() {
                const ammoType = document.getElementById('ammo-type').value;
                const shootersCount = parseInt(document.getElementById('shooters-count').value) || 0;
                const shotsPerShooter = parseInt(document.getElementById('shots-per-shooter').value) || 0;
                const useTracerAmmo = document.getElementById('tracer-ammo-btn').classList.contains('active');
                
                if (shootersCount <= 0 || shotsPerShooter <= 0) {
                    alert('Proszę wprowadzić poprawne wartości!');
                    return;
                }
                
                const totalAmmo = shootersCount * shotsPerShooter;
                let regularAmmo = totalAmmo;
                let tracerAmmo = 0;
                
                if (useTracerAmmo) {
                    // Calculate in 3:1 ratio (regular:tracer)
                    regularAmmo = Math.ceil(totalAmmo * 0.75);
                    tracerAmmo = Math.floor(totalAmmo * 0.25);
                    
                    // Adjust if necessary to make the total correct
                    if (regularAmmo + tracerAmmo !== totalAmmo) {
                        regularAmmo = totalAmmo - tracerAmmo;
                    }
                    
                    ammoBreakdown.classList.remove('hidden');
                } else {
                    ammoBreakdown.classList.add('hidden');
                }
                
                const ammoPrice = ammoPrices[ammoType];
                const totalCost = (totalAmmo * ammoPrice).toFixed(2);
                
                // Update results
                document.getElementById('ammo-type-result').textContent = ammoNames[ammoType];
                document.getElementById('shooters-result').textContent = shootersCount;
                document.getElementById('ammo-per-person-result').textContent = shotsPerShooter + ' szt.';
                document.getElementById('total-ammo-result').textContent = totalAmmo + ' szt.';
                document.getElementById('regular-ammo-result').textContent = regularAmmo + ' szt.';
                document.getElementById('tracer-ammo-result').textContent = tracerAmmo + ' szt.';
                document.getElementById('total-cost-result').textContent = totalCost + ' zł';
                
                // Show results
                ammoResults.classList.remove('hidden');
            });
            
            
            // Collimator tabs
            const weatherTabBtn = document.getElementById('weather-tab-btn');
            const collimatorTabBtn = document.getElementById('collimator-tab-btn');
            const weatherConditions = document.getElementById('weather-conditions');
            const collimatorSettings = document.getElementById('collimator-settings');
            
            weatherTabBtn.addEventListener('click', function() {
                weatherTabBtn.classList.add('active');
                collimatorTabBtn.classList.remove('active');
                weatherConditions.classList.remove('hidden');
                collimatorSettings.classList.add('hidden');
            });
            
            collimatorTabBtn.addEventListener('click', function() {
                collimatorTabBtn.classList.add('active');
                weatherTabBtn.classList.remove('active');
                collimatorSettings.classList.remove('hidden');
                weatherConditions.classList.add('hidden');
            });
            
            // Collimator calculator
            const calculateAdjustmentBtn = document.getElementById('calculate-adjustment-btn');
            const adjustmentResults = document.getElementById('adjustment-results');
            
            calculateAdjustmentBtn.addEventListener('click', function() {
                const distance = parseInt(document.getElementById('distance').value) || 100;
                const currentX = parseFloat(document.getElementById('current-x').value) || 0;
                const currentY = parseFloat(document.getElementById('current-y').value) || 0;
                const clicksPerMOA = parseInt(document.getElementById('clicks-per-moa').value) || 4;
                
                // Calculate MOA adjustment
                // 1 MOA ≈ 2.908 cm at 100 meters
                // Scale for distance: MOA = (deviation in cm * 100) / (2.908 * distance in meters)
                const moaPerCmAt100m = 1 / 2.908;
                
                // Convert to MOA based on distance
                const horizontalMOA = currentX * moaPerCmAt100m * (100 / distance);
                const verticalMOA = currentY * moaPerCmAt100m * (100 / distance);
                
                // Convert MOA to clicks
                const horizontalClicks = Math.round(horizontalMOA * clicksPerMOA);
                const verticalClicks = Math.round(verticalMOA * clicksPerMOA);
                
                // Update results
                document.getElementById('horizontal-clicks').textContent = 
                    Math.abs(horizontalClicks) + ' kliknięć ' + 
                    (horizontalClicks > 0 ? 'w lewo' : horizontalClicks < 0 ? 'w prawo' : '');
                
                document.getElementById('vertical-clicks').textContent = 
                    Math.abs(verticalClicks) + ' kliknięć ' + 
                    (verticalClicks > 0 ? 'w dół' : verticalClicks < 0 ? 'w górę' : '');
                
                // Generate instruction
                let instruction = 'Aby skorygować punkt trafienia:';
                if (horizontalClicks !== 0) {
                    instruction += ' Obróć pokrętło poziome ' + 
                        Math.abs(horizontalClicks) + ' kliknięć ' + 
                        (horizontalClicks > 0 ? 'w lewo' : 'w prawo') + '.';
                }
                if (verticalClicks !== 0) {
                    instruction += ' Obróć pokrętło pionowe ' + 
                        Math.abs(verticalClicks) + ' kliknięć ' + 
                        (verticalClicks > 0 ? 'w dół' : 'w górę') + '.';
                }
                
                document.getElementById('adjustment-instruction').textContent = instruction;
                
                // Show results
                adjustmentResults.classList.remove('hidden');
            });
        });
    </script>
</body>
</html>
